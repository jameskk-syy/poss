<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
  <mat-horizontal-stepper [linear]="isLinear" #stepper>
      <form [formGroup]="invoiceForm" class="mx-4">
          <mat-step [stepControl]="productForm">
              <ng-template matStepLabel>Select Items</ng-template>

            <div [formGroup]="productForm" class="row">
              <div class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Quantity</mat-label>
                    <input matInput formControlName="quantity" required />
                </mat-form-field>
              </div>

              <div class="col-xl-4 col-lg-12 col-md-12 col-sm-12">
                <mat-form-field class="example-full-width" appearance="outline">
                  <mat-label>Items</mat-label>
                  <input matInput formControlName="skuCode" />
                  <mat-icon matSuffix (click)="selectItemLk()">search</mat-icon>
                </mat-form-field>
              </div> 
              <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2 d-flex justify-content-end">
                <button mat-raised-button color="primary" (click)="addItem()">
                Add Item
            </button>
            </div>
          </div>

            <div class="card">
              <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                  <div class="boxs mail_listing">
                      <div class="row">
                          <div class="body">
                              <div class="table-responsive">
                                  <div class="materialTableHeader mt-3">
                                      <div class="row">
                                          <div class="col-8">
                                              <ul class="header-buttons-left ms-0">
                                                  <li class="dropdown">
                                                      <h2>Products
                                                      </h2>
                                                  </li>
                                              </ul>
                                          </div>
                                      </div>
                                  </div>
                                  <mat-table #table matTableExporter [dataSource]="productDataSource" matSort
                                      class="mat-cell" #exporter="matTableExporter">
                                      <ng-container matColumnDef="index">
                                          <mat-header-cell *matHeaderCellDef mat-sort-header
                                              class="psl-3 tbl-col-width-per-35">Id</mat-header-cell>
                                          <mat-cell *matCellDef="let row; let i = index"
                                              class="psl-3 tbl-col-width-per-35">{{
                                              i + 1 }}</mat-cell>
                                      </ng-container>
                                      <ng-container matColumnDef="name">
                                          <mat-header-cell *matHeaderCellDef
                                              mat-sort-header
                                              class="column-nowrap psl-3 tbl-col-width-per-80">Product</mat-header-cell>
                                          <mat-cell *matCellDef="let row"
                                              (click)="onSelect(row)"
                                              class="column-nowrap psl-3 tbl-col-width-per-80">
                                              {{ row.name }}
                                          </mat-cell>
                                      </ng-container>
                                      <ng-container matColumnDef="code">
                                        <mat-header-cell *matHeaderCellDef
                                            mat-sort-header
                                            class="column-nowrap psl-3 tbl-col-width-per-80">Code</mat-header-cell>
                                        <mat-cell *matCellDef="let row"
                                            (click)="onSelect(row)"
                                            class="column-nowrap psl-3 tbl-col-width-per-80">
                                            {{ row.code }}
                                        </mat-cell>
                                    </ng-container>
                                      <ng-container matColumnDef="unit">
                                        <mat-header-cell *matHeaderCellDef
                                            mat-sort-header
                                            class="column-nowrap psl-3 tbl-col-width-per-80">Unit</mat-header-cell>
                                        <mat-cell *matCellDef="let row"
                                            (click)="onSelect(row)"
                                            class="column-nowrap psl-3 tbl-col-width-per-80">
                                            {{ row.unit }}
                                        </mat-cell>
                                    </ng-container>
                                    <ng-container matColumnDef="quantity">
                                      <mat-header-cell *matHeaderCellDef
                                          mat-sort-header
                                          class="column-nowrap psl-3 tbl-col-width-per-80">Quantity</mat-header-cell>
                                      <mat-cell *matCellDef="let row"
                                          (click)="onSelect(row)"
                                          class="column-nowrap psl-3 tbl-col-width-per-80">
                                          {{ row.quantity }}
                                      </mat-cell>
                                    </ng-container>
                                      <ng-container matColumnDef="actions">
                                          <mat-header-cell
                                              class="column-nowrap psl-3 tbl-col-width-per-80"
                                              *matHeaderCellDef>Actions</mat-header-cell>
                                          <mat-cell *matCellDef="let row; let i = index"
                                              class="column-nowrap psl-3 tbl-col-width-per-80">
                                              <button mat-icon-button color="accent"
                                                  (click)="$event.stopPropagation()"
                                                  (click)="removeItem(i)"
                                                  class="tbl-action-btn">
                                                  <app-feather-icons [icon]="'trash-2'"
                                                      [class]="'tbl-fav-delete'"></app-feather-icons>
                                              </button>
                                          </mat-cell>
                                      </ng-container>
                                      <mat-header-row
                                          *matHeaderRowDef="productDisplayedColumns">
                                      </mat-header-row>

                                      <mat-row
                                          *matRowDef="let row; let i = index; columns: productDisplayedColumns"
                                          [class.odd-row]="i % 2"
                                          [class.even-row]="!(i % 2)"
                                          [style.cursor]="'pointer'" matRipple>
                                      </mat-row>
                                      <mat-cell *matNoDataRow colspan="4">
                                          No data matching the filter "{{
                                          input.value
                                          }}"</mat-cell>
                                  </mat-table>
                                  <div *ngIf="productNotAdded">
                                      <p class="p-3">
                                          No item selected yet
                                      </p>
                                  </div>
                                  <mat-paginator [pageSize]="2"
                                      #collectorsPaginator="matPaginator"
                                      [pageSizeOptions]="[2, 5, 10, 20, 30, 40, 50, 100]"
                                      aria-label="Select page of users"></mat-paginator>
                                      </div>
                                  </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mr 3 d-flex justify-content-end">
                    <button mat-raised-button matStepperNext color="primary">Next
                    </button>
                </div>
              </mat-step>

        <mat-step [stepControl]="invoiceForm">
            <ng-template matStepLabel>General Details</ng-template>
              <div class="row">
               <div class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Total Amount</mat-label>
                    <input matInput formControlName="amount" required />
                    <mat-error *ngIf="invoiceForm.get('amount').hasError('required')">
                        Total Amount is required
                    </mat-error>
                </mat-form-field>
               </div>
               <div class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Invoice Number</mat-label>
                    <input matInput formControlName="invoiceNo" required />
                    <mat-error *ngIf="invoiceForm.get('invoiceNo').hasError('required')">
                        Invoice Number is required
                    </mat-error>
                </mat-form-field>
                </div>
                <div class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Description</mat-label>
                    <input matInput formControlName="description" required />
                    <mat-error *ngIf="invoiceForm.get('description').hasError('required')">
                        Description is required
                    </mat-error>
                </mat-form-field>
                </div>
                <div class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Date</mat-label>
                    <input matInput [matDatepicker]="picker" formControlName="date" 
                        [value]="invoiceForm.get('date').value | date: 'yyyy-MM-dd'" 
                        (dateChange)="onSelectDate()">
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                    <mat-error *ngIf="invoiceForm.get('date').hasError('required')">
                        Date is required
                    </mat-error>
                </mat-form-field>
                </div>
                <!-- <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                    <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>Payment Method</mat-label>
                        <mat-select formControlName="paymentMode" required>
                            <mat-option *ngFor="let paymentMode of paymentMethods" [value]="paymentMode">
                              {{ stat }}
                            </mat-option>
                          </mat-select>
                        <mat-error *ngIf="invoiceForm.get('paymentMode').hasError('required')">
                            paymentMethods is required
                        </mat-error>
                    </mat-form-field>
                </div> -->


              </div>
               <div class="d-flex justify-content-end">
                <button mat-raised-button matStepperPrevious color="accent" class="msr-2">
                    Back
                </button>
                <button mat-raised-button matStepperNext color="primary">
                    Next
                </button>
              </div>
            </mat-step>
            <mat-step [stepControl]="invoiceForm">
              <ng-template matStepLabel>General Details</ng-template>
                <div class="row">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                        <p>Confirm Details and Submit</p>
                    </div>  
              <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                  <div class="example-button-row" align="end">
                    <button mat-raised-button color="primary"[disabled]="!invoiceForm.valid" (click)="onSubmit()" >
                      <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
                      <b>Submit</b>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            </mat-step>
          </form>
        </mat-horizontal-stepper>
      </div>
       
  