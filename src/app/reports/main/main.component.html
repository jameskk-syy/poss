<section class="content">
  <div class="content-block">
    <div class="block-header">
      <!-- breadcrumb -->
      <app-breadcrumb [title]="'Reports'" [items]="['Staff', 'Reports']" [active_item]="'All reports'"></app-breadcrumb>
    </div>


    <div class="row">
      <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
        <div class="card">
          <br>
          <div class="header">
            <h2>Collections Report</h2>
          </div>
          <div class="body">
            <div class="doc-file-type">
              <ul class="list-unstyled" style="position: relative; height: 500px;" [perfectScrollbar]>

                <li (click)="DailyCOllectionReport()" class="d-flex mb-3">
                  <!-- <div class="example-action-buttons">
                      <button mat-button (click)="accordion.openAll()">Expand All</button>
                      <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                    </div> -->
                  <mat-accordion class="example-headers-align" multi>

                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Collection per Date report
                        </mat-panel-title>
                        <!-- <mat-panel-description>
                          Inform the date you wish to travel
                          <mat-icon>date_range</mat-icon>
                        </mat-panel-description> -->
                      </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="reportCollectionForm">
                        <div class="row">
                          <!-- <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Report Format</mat-label>
                            <mat-select formControlName="format" required>
                              <mat-option value="pdf">PDF</mat-option>
                              <mat-option value="excel">Excel</mat-option>
                            </mat-select>
                          </mat-form-field> -->
                          <mat-radio-group aria-label="Select an option" formControlName="format">
                            <mat-radio-button value="pdf">PDF</mat-radio-button>
                            <mat-radio-button value="excel">Excel</mat-radio-button>
                          </mat-radio-group>

                          <mat-form-field class="m-l-5">
                            <input matInput [matDatepicker]="picker" placeholder="Choose a date" formControlName="date">
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                          </mat-form-field>
                          <!-- <mat-error *ngIf="reportCollectionForm.get('date').hasError('required')">
                            Date is required
                          </mat-error> -->




                          <div class="example-button-row">

                            <button mat-raised-button color="primary" [disabled]="!reportCollectionForm.valid"
                              (click)="generateDateReport()">
                              <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                              <b>Generate</b>
                            </button>
                          </div>

                        </div>

                      </form>



                    </mat-expansion-panel>
                  </mat-accordion>
                </li>

                <li (click)="collectionsPerFarmer()" class="d-flex mb-3">

                  <!-- <div class="example-action-buttons">
                          <button mat-button (click)="accordion.openAll()">Expand All</button>
                          <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                        </div> -->
                  <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Monthly Route Delivery Report
                        </mat-panel-title>
                      </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="reportFarmerForm">
                        <div class="row">
                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Month</mat-label>
                            <mat-select formControlName="month" required>
                              <mat-option *ngFor="let month of months" [value]="month.value">{{ month.name
                                }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="reportFarmerForm.get('month').hasError('required')">
                              Month Is required
                            </mat-error>
                          </mat-form-field>
                        </div>
                        <div class="row">
                          <mat-form-field class="example-full-width mb-2" appearance="legacy">
                            <mat-label>Route</mat-label>
                            <input readonly formControlName="route" [value]="route" matInput required />
                            <mat-icon matSuffix (click)="selectRoute()">search</mat-icon>
                          </mat-form-field>               
                          <div class="example-button-row">
                            <button mat-raised-button color="primary" [disabled]="!reportFarmerForm.valid"
                              (click)="generateCollectionsPerFarmerPerRoute()">
                              <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                              <b>Generate</b>
                            </button>
                          </div>

                        </div>
                      </form>

                    </mat-expansion-panel>
                  </mat-accordion>

                </li>
                
                <li (click)="collectionsPerFarmer()" class="d-flex mb-3">

                  <!-- <div class="example-action-buttons">
                          <button mat-button (click)="accordion.openAll()">Expand All</button>
                          <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                        </div> -->
                  <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Route Deliveries Per Date
                        </mat-panel-title>
                        <!-- <mat-panel-description>
                              Inform the date you wish to travel
                              <mat-icon>date_range</mat-icon>
                            </mat-panel-description> -->
                      </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="reportCollectionForm3">
                        <div class="row">
                          <mat-form-field class="m-l-5">
                            <input matInput [matDatepicker]="picker2" placeholder="Choose a date"
                              formControlName="date">
                            <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                            <mat-datepicker #picker2></mat-datepicker>
                          </mat-form-field>
                        <mat-form-field class="example-full-width mb-2" appearance="legacy">
                            <mat-label>Route</mat-label>
                            <input readonly formControlName="route" [value]="route" matInput required />
                            <mat-icon matSuffix (click)="selectRoute()">search</mat-icon>
                          </mat-form-field>               
                          <div class="example-button-row">
                            <button mat-raised-button color="primary" [disabled]="!reportCollectionForm3.valid"
                              (click)="generateCollectionsForRoutePerDate()">
                              <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                              <b>Generate</b>
                            </button>
                          </div>

                        </div>
                      </form>

                    </mat-expansion-panel>
                  </mat-accordion>

                </li>

                <li (click)="collectionsPerCollector('Report For Single User Action Items')" class="d-flex mb-3">

                  <!-- <div class="example-action-buttons">
                          <button mat-button (click)="accordion.openAll()">Expand All</button>
                          <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                        </div> -->
                  <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Daily Route Delivery Summary
                        </mat-panel-title>
                        <!-- <mat-panel-description>
                              Inform the date you wish to travel
                              <mat-icon>date_range</mat-icon>
                            </mat-panel-description> -->
                      </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="reportCollectionForm2">
                        <div class="row">

                          <mat-form-field class="m-l-5">
                            <input matInput [matDatepicker]="picker3" placeholder="Choose a date"
                              formControlName="date">
                            <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                            <mat-datepicker #picker3></mat-datepicker>
                          </mat-form-field>

                          <div class="example-button-row">

                            <button mat-raised-button color="primary" [disabled]="!reportCollectionForm2.valid"
                              (click)="dailyRouteSummary()">
                              <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                              <b>Generate</b>
                            </button>
                          </div>

                        </div>
                      </form>

                    </mat-expansion-panel>
                  </mat-accordion>

                </li>

                <li (click)="collectionsPerCollector('Report For Single User Action Items')" class="d-flex mb-3">

                  <!-- <div class="example-action-buttons">
                          <button mat-button (click)="accordion.openAll()">Expand All</button>
                          <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                        </div> -->
                  <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Monthly Route Summary
                        </mat-panel-title>
                        <!-- <mat-panel-description>
                              Inform the date you wish to travel
                              <mat-icon>date_range</mat-icon>
                            </mat-panel-description> -->
                      </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="reportCollectionForm1">
                        <div class="row">
                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Month</mat-label>
                            <mat-select formControlName="month" required>
                              <mat-option *ngFor="let month of months" [value]="month.value">{{ month.name
                                }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="reportCollectionForm1.get('month').hasError('required')">
                              Month Is required
                            </mat-error>
                          </mat-form-field>
                        </div>
                        <div class="row">
                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Year</mat-label>
                            <mat-select formControlName="year" required>
                              <mat-option *ngFor="let year of years" [value]="year.value">
                                {{ year.name }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="reportCollectionForm1.get('year').hasError('required')">
                              Year Is required
                            </mat-error>
                          </mat-form-field>

                          <div class="example-button-row">

                            <button mat-raised-button color="primary" [disabled]="!reportCollectionForm1.valid"
                              (click)="monthlyRouteSummary()">
                              <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                              <b>Generate</b>
                            </button>
                          </div>

                        </div>
                      </form>

                    </mat-expansion-panel>
                  </mat-accordion>

                </li>
                <!-- <li (click)="collectionsPerLocation('Report For Single User Action Items')" class="d-flex mb-3">


               
                  <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Total Collection per route for specific date report
                        </mat-panel-title>
                      
                      </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="reportCollectionForm3">
                        <div class="row">
                         
                          

                          <mat-form-field class="m-l-5">
                            <input matInput [matDatepicker]="picker3" placeholder="Choose a date"
                              formControlName="date">
                            <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                            <mat-datepicker #picker3></mat-datepicker>
                          </mat-form-field>
                          <mat-error *ngIf="reportCollectionForm3.get('date').hasError('required')">
                            Date is required
                          </mat-error>
                       
                          <div class="example-button-row">

                            <button mat-raised-button color="primary" [disabled]="!reportCollectionForm3.valid"
                              (click)="generateCollectionsPerLocations()">
                              <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                              <b>Generate</b>
                            </button>
                          </div>

                        </div>
                      </form>

                    </mat-expansion-panel>
                  </mat-accordion>


                </li> -->
                <!-- <li (click)="collectionsPerLocation('Report For Single User Action Items')" class="d-flex mb-3">


                  <div class="example-action-buttons">
                            <button mat-button (click)="accordion.openAll()">Expand All</button>
                            <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                          </div>
                  <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Total Collection per pick-up Location for specific date report
                        </mat-panel-title>
                        <mat-panel-description>
                                Inform the date you wish to travel
                                <mat-icon>date_range</mat-icon>
                              </mat-panel-description>
                      </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="reportCollectionFormp">
                        <div class="row">
                          <mat-radio-group aria-label="Select an option" formControlName="format">
                            <mat-radio-button value="pdf">PDF</mat-radio-button>
                            <mat-radio-button value="excel">Excel</mat-radio-button>
                          </mat-radio-group>
                          

                          <mat-form-field class="m-l-5">
                            <input matInput [matDatepicker]="pickerp" placeholder="Choose a date"
                              formControlName="date">
                            <mat-datepicker-toggle matSuffix [for]="pickerp"></mat-datepicker-toggle>
                            <mat-datepicker #pickerp></mat-datepicker>
                          </mat-form-field>
                          <mat-error *ngIf="reportCollectionForm3.get('date').hasError('required')">
                            Date is required
                          </mat-error>



                          <div class="example-button-row">

                            <button mat-raised-button color="primary" [disabled]="!reportCollectionFormp.valid"
                              (click)="generateCollectionsPerLocationsp()">
                              <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                              <b>Generate</b>
                            </button>
                          </div>

                        </div>
                      </form>

                    </mat-expansion-panel>
                  </mat-accordion>


                </li> -->
                <!-- <li (click)="collectionsPerLocation('Report For Single User Action Items')" class="d-flex mb-3"> 


                  <div class="example-action-buttons">
                            <button mat-button (click)="accordion.openAll()">Expand All</button>
                            <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                          </div>
                  <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Total Collection per route for specific month report
                        </mat-panel-title>
                        <mat-panel-description>
                                Inform the date you wish to travel
                                <mat-icon>date_range</mat-icon>
                              </mat-panel-description>
                      </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="reportCollectionFormm">
                        <div class="row">
                          <mat-radio-group aria-label="Select an option" formControlName="format">
                            <mat-radio-button value="pdf">PDF</mat-radio-button>
                            <mat-radio-button value="excel">Excel</mat-radio-button>
                          </mat-radio-group>
                          

                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Month</mat-label>
                            <mat-select formControlName="month" required>
                              <mat-option *ngFor="let month of months" [value]="month.name">{{ month.name
                                }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="reportCollectionFormm.get('month').hasError('required')">
                              Month Is required
                            </mat-error>
                          </mat-form-field>
                          <mat-error *ngIf="reportCollectionForm3.get('date').hasError('required')">
                            Date is required
                          </mat-error>

                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Year</mat-label>
                            <mat-select formControlName="year" required>
                              <mat-option *ngFor="let year of years" [value]="year">{{ year
                                }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="reportCollectionFormm.get('year').hasError('required')">
                              Year Is required
                            </mat-error>
                          </mat-form-field>

                          <div class="example-button-row">

                            <button mat-raised-button color="primary" [disabled]="!reportCollectionFormm.valid"
                              (click)="generateCollectionsPerRoutePerMonth()">
                              <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                              <b>Generate</b>
                            </button>
                          </div>

                        </div>
                      </form>

                    </mat-expansion-panel>
                  </mat-accordion>


                </li> -->
                <!-- <li (click)="collectionsPerLocation('Report For Single User Action Items')" class="d-flex mb-3"> -->


                  <!-- <div class="example-action-buttons">
                            <button mat-button (click)="accordion.openAll()">Expand All</button>
                            <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                          </div> -->
                  <!-- <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Collection per Pick-Up Location for specific date report
                        </mat-panel-title> -->
                        <!-- <mat-panel-description>
                                Inform the date you wish to travel
                                <mat-icon>date_range</mat-icon>
                              </mat-panel-description> -->
                      <!-- </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="collectionPerpLocationsForm">

                        <div class="row">
                          <div>
                            <mat-radio-group aria-label="Select an option" formControlName="format">
                              <mat-radio-button value="pdf">PDF</mat-radio-button>
                              <mat-radio-button value="excel">Excel</mat-radio-button>
                            </mat-radio-group>
                          </div>

                          <mat-form-field class="example-full-width" appearance="outline">
                            <mat-label>Select PickUpLocation</mat-label>
                            <input matInput formControlName="pul" required readonly />
                            <mat-icon matSuffix (click)="selectPickUpLocation()">search</mat-icon>
                            <mat-error *ngIf="collectionPerpLocationsForm.get('pul').hasError('required')">
                              Pick-Up Location is required
                            </mat-error>
                          </mat-form-field>
                          <mat-form-field class="m-l-5">
                            <input matInput [matDatepicker]="picker4" placeholder="Choose a date"
                              formControlName="date">
                            <mat-datepicker-toggle matSuffix [for]="picker4"></mat-datepicker-toggle>
                            <mat-datepicker #picker4></mat-datepicker>
                          </mat-form-field> -->
                          <!-- <mat-error *ngIf="collectionPerpLocationsForm.get('date').hasError('required')">
                            Date is required
                          </mat-error> -->


                          <!-- <div class="example-button-row">

                            <button mat-raised-button color="primary" [disabled]="!collectionPerpLocationsForm.valid"
                              (click)="generateCollectionsPerPickUpLocations()">
                              <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                              <b>Generate</b>
                            </button>
                          </div> -->

                        <!-- </div>
                      </form>

                    </mat-expansion-panel>
                  </mat-accordion>


                </li> -->
                

              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
        <div class="card">
          <br>
          <div class="header">
            <h2>Farmer Reports</h2>
          </div>
          <div class="body">
            <div class="doc-file-type"> 
              <ul class="list-unstyled" style="position: relative; height: 500px;" [perfectScrollbar]>

                <li (click)="farmerCollectionsReport()" class="d-flex mb-3">
                  <span class="msr-3 align-self-center img-icon info-rgba text-info"><i
                      class="far fa-file-archive"></i></span>
                  <div class="set-flex">
                    <h5 class="font-16 mb-1">Farmers Collections report</h5>
                    <p>Collections report for specific farmer</p>
                  </div>
                  <div class="ms-auto">
                    <td>
                      <i class="far fa-arrow-alt-circle-down"></i>
                    </td>
                  </div>
                </li>
                <li (click)="farmerStatement()" class="d-flex mb-3">
                  <span class="msr-3 align-self-center img-icon info-rgba text-info"><i
                      class="far fa-file-archive"></i></span>

                  <div class="set-flex">
                    <h5 class="font-16 mb-1">Farmers Statement report</h5>
                    <p>Statement report for specific farmer</p>
                  </div>
                  <div class="ms-auto">
                    <td>
                      <i class="far fa-arrow-alt-circle-down"></i>
                    </td>
                  </div>
                </li>
                <!-- <li (click)="farmerProductReport()" class="d-flex mb-3">
                  <span class="msr-3 align-self-center img-icon info-rgba text-info"><i
                      class="far fa-file-archive"></i></span>

                  <div class="set-flex">
                    <h5 class="font-16 mb-1">Farmers Product Allocation report</h5>
                    <p> Report for specific farmer</p>
                  </div>
                  <div class="ms-auto">
                    <td>
                      <i class="far fa-arrow-alt-circle-down"></i>
                    </td>
                  </div>
                </li> -->

              </ul>
            </div>
          </div>
        </div>
      </div>
      <!-- <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
        <div class="card">
          <br>
          <div class="header">
            <h2>Generate Payment Report</h2>
          </div>
          <div class="body">
            <div class="doc-file-type">
              <ul class="list-unstyled" style="position: relative; height: 500px;" [perfectScrollbar]>
                <li (click)="collectionsPerLocation('Report For Single User Action Items')" class="d-flex mb-3"> -->


                  <!-- <div class="example-action-buttons">
                            <button mat-button (click)="accordion.openAll()">Expand All</button>
                            <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                          </div> -->
                  <!-- <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Payment File report
                        </mat-panel-title> -->
                        <!-- <mat-panel-description>
                                Inform the date you wish to travel
                                <mat-icon>date_range</mat-icon>
                              </mat-panel-description> -->
                      <!-- </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="paymentFileForm">
                        <div class="row">
                          <mat-form-field class="example-full-width" appearance="outline">
                            <mat-label>Select PickUpLocation</mat-label>
                            <input matInput formControlName="pul" required readonly />
                            <mat-icon matSuffix (click)="choosePickUpLocation()">search</mat-icon>
                            <mat-error *ngIf="paymentFileForm.get('pul').hasError('required')">
                              Collection center is required
                            </mat-error>
                          </mat-form-field>

                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Month</mat-label>
                            <mat-select formControlName="month" required>
                              <mat-option *ngFor="let month of months" [value]="month.value">{{ month.name
                                }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="paymentFileForm.get('month').hasError('required')">
                              Month Is required
                            </mat-error>
                          </mat-form-field>
                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Payment Mode</mat-label>
                            <mat-select formControlName="mode" required>
                              <mat-option value="M-pesa">MPesa</mat-option>
                              <mat-option value="Cash">Cash</mat-option>
                              <mat-option value="Bank">Bank</mat-option>
                              <mat-option value="cooperative saccos">Cooperative Saccos</mat-option>
                            </mat-select>
                            <mat-error *ngIf="paymentFileForm.get('mode').hasError('required')">
                              Payment mode Is required
                            </mat-error>
                          </mat-form-field>
                        </div>

                        <div class="example-button-row">

                          <button mat-raised-button color="primary" [disabled]="!paymentFileForm.valid"
                            (click)="generatePaymentFile()">
                            <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                            <b>Generate</b>
                          </button>
                        </div>


                      </form>

                    </mat-expansion-panel>
                  </mat-accordion>


                </li>
              </ul>
            </div>
          </div>
        </div>
      </div> -->


      <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
        <div class="card">
          <br>
          <div class="header">
            <h2>Payment Report</h2>
          </div>
          <div class="body">
            <div class="doc-file-type">
              <ul class="list-unstyled" style="position: relative; height: 500px;" [perfectScrollbar]>
                <li class="d-flex mb-3">


                  <!-- <div class="example-action-buttons">
                            <button mat-button (click)="accordion.openAll()">Expand All</button>
                            <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                          </div> -->
                  <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Payroll - Payment Modes
                        </mat-panel-title>
                        <!-- <mat-panel-description>
                                Inform the date you wish to travel
                                <mat-icon>date_range</mat-icon>
                              </mat-panel-description> -->
                      </mat-expansion-panel-header>

                      <!-- <mat-radio-group aria-label="Select an option" formControlName="format">
                        <mat-radio-button value="pdf">PDF</mat-radio-button>
                        <mat-radio-button value="excel">Excel</mat-radio-button>
                      </mat-radio-group> -->

                      <form class="register-form" [formGroup]="paymentFileForm1">
                        <div class="row">
                          <!-- <mat-form-field class="example-full-width" appearance="outline">
                            <mat-label>Select Route</mat-label>
                            <input matInput formControlName="pul" required readonly />
                            <mat-icon matSuffix (click)="choosePickUpLocation()">search</mat-icon>
                            <mat-error *ngIf="paymentFileForm.get('pul').hasError('required')">
                             Route is required
                            </mat-error>
                          </mat-form-field> -->
                          <mat-radio-group aria-label="select report type" formControlName="format">
                            <mat-radio-button value="pdf">pdf</mat-radio-button>
                            <mat-radio-button value="excel">excel</mat-radio-button>
                          </mat-radio-group>

                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Month</mat-label>
                            <mat-select formControlName="month" required>
                              <mat-option *ngFor="let month of months" [value]="month.value">{{ month.name
                                }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="paymentFileForm1.get('month').hasError('required')">
                              Month Is required
                            </mat-error>
                          </mat-form-field>
                          <!-- <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Payment Mode</mat-label>
                            <mat-select formControlName="mode" required>
                              <mat-option value="M-pesa">MPesa</mat-option>
                              <mat-option value="Cash">Cash</mat-option>
                              <mat-option value="Bank">Bank</mat-option>
                              <mat-option value="cooperative saccos">Cooperative Saccos</mat-option>
                            </mat-select>
                            <mat-error *ngIf="paymentFileForm.get('mode').hasError('required')">
                              Payment mode Is required
                            </mat-error>
                          </mat-form-field> -->
                        </div>
                        <div class="row">
                          <mat-form-field class="example-full-width" appearance="outline">
                            <mat-label>Select Channel</mat-label>
                            <mat-select formControlName="channel" required>
                              <mat-option *ngFor="let bank of banks" [value]="bank.name">
                                {{bank.name}}
                              </mat-option>
                            </mat-select>
                            <mat-error *ngIf="paymentFileForm1.get('channel').hasError('required')">payment channel is needed</mat-error>
                          </mat-form-field>
                        </div>

                        <div class="row">
                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Year</mat-label>
                            <mat-select formControlName="year" required>
                              <mat-option *ngFor="let year of years" [value]="year.name">{{ year.name
                                }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="paymentFileForm1.get('year').hasError('required')">
                              Year Is required
                            </mat-error>
                          </mat-form-field>
                        </div>

                        <div class="example-button-row">

                          <button mat-raised-button color="primary" [disabled]="!paymentFileForm1.valid"
                            (click)="generatePayroll()">
                            <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                            <b>Generate</b>
                          </button>
                        </div>


                      </form>

                    </mat-expansion-panel>
                  </mat-accordion>


                </li>

                <li class="d-flex mb-3">
                  <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>Full Payroll</mat-panel-title>
                      </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="payrollForm">
                        <div class="row">
                          <mat-radio-group aria-label="select report type" formControlName="format">
                            <mat-radio-button value="excel">excel</mat-radio-button>
                            <mat-radio-button value="pdf">pdf</mat-radio-button>
                          </mat-radio-group>
                          
                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Month</mat-label>
                            <mat-select formControlName="month" required>
                              <mat-option *ngFor="let month of months" [value]="month.value">{{ month.name
                                }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="payrollForm.get('month').hasError('required')">
                              Month Is required
                            </mat-error>
                          </mat-form-field>
                        </div>

                        <div class="row">
                          <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Year</mat-label>
                            <mat-select formControlName="year" required>
                              <mat-option *ngFor="let year of years" [value]="year.value">{{year.value}}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="payrollForm.get('year').hasError('required')">
                              year is required
                            </mat-error>
                          </mat-form-field>
                        </div>

                        <div class="example-button-row">
                          <button mat-raised-button color="primary" [disabled]="!payrollForm.valid" (click)="getFullPayroll()">
                            <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                            <b>Generate</b>
                          </button>
                        </div>
                      </form>
                    </mat-expansion-panel>
                  </mat-accordion>
                </li>
              
                <li (click)="collectionsPerLocation('Report For Single User Action Items')" class="d-flex mb-3">


                  <!-- <div class="example-action-buttons">
                            <button mat-button (click)="accordion.openAll()">Expand All</button>
                            <button mat-button (click)="accordion.closeAll()">Collapse All</button>
                          </div> -->
                  <!-- <mat-accordion class="example-headers-align" multi>
                    <mat-progress-bar mode="indeterminate" *ngIf="isloading"></mat-progress-bar>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Mpesa report
                        </mat-panel-title> -->
                        <!-- <mat-panel-description>
                                Inform the date you wish to travel
                                <mat-icon>date_range</mat-icon>
                              </mat-panel-description> -->
                      <!-- </mat-expansion-panel-header>

                      <form class="register-form" [formGroup]="paymentFileForm2">
                        <div class="row"> -->
                          <!-- <mat-form-field class="example-full-width" appearance="outline">
                            <mat-label>Select Route</mat-label>
                            <input matInput formControlName="pul" required readonly />
                            <mat-icon matSuffix (click)="choosePickUpLocation()">search</mat-icon>
                            <mat-error *ngIf="paymentFileForm.get('pul').hasError('required')">
                             Route is required
                            </mat-error>
                          </mat-form-field> -->

                          <!-- <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Month</mat-label>
                            <mat-select formControlName="month" required>
                              <mat-option *ngFor="let month of months" [value]="month.name">{{ month.name
                                }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="paymentFileForm2.get('month').hasError('required')">
                              Month Is required
                            </mat-error>
                          </mat-form-field> -->
                          <!-- <mat-form-field class="example-full-width mb-1" appearance="outline">
                            <mat-label>Select Payment Mode</mat-label>
                            <mat-select formControlName="mode" required>
                              <mat-option value="M-pesa">MPesa</mat-option>
                              <mat-option value="Cash">Cash</mat-option>
                              <mat-option value="Bank">Bank</mat-option>
                              <mat-option value="cooperative saccos">Cooperative Saccos</mat-option>
                            </mat-select>
                            <mat-error *ngIf="paymentFileForm.get('mode').hasError('required')">
                              Payment mode Is required
                            </mat-error>
                          </mat-form-field> -->
                        <!-- </div> -->
<!-- 
                        <div class="example-button-row">

                          <button mat-raised-button color="primary" [disabled]="!paymentFileForm2.valid"
                            (click)="generateMpesaPaymentFile()">
                            <span *ngIf="isloading" class="spinner-border spinner-border-sm mr-1"></span>
                            <b>Generate</b>
                          </button>
                        </div> -->
<!-- 

                      </form>

                    </mat-expansion-panel>
                  </mat-accordion> -->


                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      
    </div>

  </div>
</section>